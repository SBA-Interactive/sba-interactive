import{_ as n,am as p,ar as o,an as u,a5 as d,ae as l,k as m,K as _,aW as v,af as b}from"./render.BCs50Su8.js";class w{anchor;#t=new Map;#s=new Map;#e=new Map;#a=new Set;#i=!0;constructor(e,s=!0){this.anchor=e,this.#i=s}#f=()=>{var e=n;if(this.#t.has(e)){var s=this.#t.get(e),t=this.#s.get(s);if(t)p(t),this.#a.delete(s);else{var i=this.#e.get(s);i&&(this.#s.set(s,i.effect),this.#e.delete(s),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),t=i.effect)}for(const[a,f]of this.#t){if(this.#t.delete(a),a===e)break;const r=this.#e.get(f);r&&(o(r.effect),this.#e.delete(f))}for(const[a,f]of this.#s){if(a===s||this.#a.has(a))continue;const r=()=>{if(Array.from(this.#t.values()).includes(a)){var c=document.createDocumentFragment();v(f,c),c.append(d()),this.#e.set(a,{effect:f,fragment:c})}else o(f);this.#a.delete(a),this.#s.delete(a)};this.#i||!t?(this.#a.add(a),u(f,r,!1)):r()}}};#r=e=>{this.#t.delete(e);const s=Array.from(this.#t.values());for(const[t,i]of this.#e)s.includes(t)||(o(i.effect),this.#e.delete(t))};ensure(e,s){var t=n,i=b();if(s&&!this.#s.has(e)&&!this.#e.has(e))if(i){var a=document.createDocumentFragment(),f=d();a.append(f),this.#e.set(e,{effect:l(()=>s(f)),fragment:a})}else this.#s.set(e,l(()=>s(this.anchor)));if(this.#t.set(t,e),i){for(const[r,h]of this.#s)r===e?t.skipped_effects.delete(h):t.skipped_effects.add(h);for(const[r,h]of this.#e)r===e?t.skipped_effects.delete(h.effect):t.skipped_effects.add(h.effect);t.oncommit(this.#f),t.ondiscard(this.#r)}else m&&(this.anchor=_),this.#f()}}export{w as B};
